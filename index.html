<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gravar Voz com Coração Pulsante</title>
    <link rel="icon" type="image/png" href="favicon.ico"> <!-- Link to your favicon -->
    <style>
        body {
            margin: 0; 
            font-family: Arial, sans-serif; 
        }
        header {
            background-color: #4CAF50; 
            padding: 20px;
            color: white; 
            text-align: center;
        }
        main {
            background-color: black; 
            color: white; 
            padding: 20px;
            text-align: center;
        }
        footer {
            background-color: gold; 
            padding: 10px;
            text-align: center; 
        }
        .heartbeat {
            display: inline-block;
            animation: heartbeat 1.5s infinite paused; /* Animação inicialmente pausada */
        }
        @keyframes heartbeat {
            0%, 20% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1); /* Aumenta o tamanho do coração */
            }
            100% {
                transform: scale(1); /* Retorna ao tamanho normal */
            }
        }
    </style>
</head>
<body>

    <header>
        <h1>Gravar e Salvar Sua Voz</h1>
    </header>

    <main>
        <h2>Controle de Gravação ?</h2>
        <button id="stopButton" disabled>Parar Gravação ?</button>
        <br><br>
        <div class="heartbeat" id="heartContainer">
            <img src="https://images.hindustantimes.com/img/2022/01/27/550x309/healthy-gdae63cff2_1280_1643268445755_1643268464696.png" alt="Coração ECG" width="200" height="200"/>
        </div>
        <audio id="audioPlayback" controls style="display: none;"></audio>
        <a id="downloadLink" style="display: none;">Baixar Gravação ?</a>
        <div id="statusMessage"></div> <!-- Elemento para a mensagem de status -->
    </main>

    <footer>
        <p>© 2025 Minha Página Web</p>
    </footer>

    <script>
        let mediaRecorder;
        let audioChunks = [];

        // Verifique se a API SpeechRecognition está disponível
        const SpeechRecognition = window.SpeechRecognition || window.webkit.SpeechRecognition;

        if (!SpeechRecognition) {
            alert("Desculpe, esta funcionalidade de reconhecimento de voz não é suportada pelo seu navegador. Por favor, use o Google Chrome ou Microsoft Edge.");
            } else {
            alert("Funciona");
                // ... resto do seu código ...
            }

        if (SpeechRecognition) {
            statusMessage.innerText = "SpeechRecognition está disponível. Você pode usar comandos de voz."; // Mensagem de sucesso
            const recognition = new SpeechRecognition();
            recognition.interimResults = true; 

            const heartContainer = document.getElementById('heartContainer');

            // Função para começar a gravação
            function startRecording() {
                navigator.mediaDevices.getUserMedia({ audio: true })
                    .then(stream => {
                        mediaRecorder = new MediaRecorder(stream);

                        mediaRecorder.ondataavailable = event => {
                            audioChunks.push(event.data);
                        };

                        mediaRecorder.onstop = () => {
                            const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                            const audioUrl = URL.createObjectURL(audioBlob);
                            document.getElementById('audioPlayback').src = audioUrl;
                            document.getElementById('audioPlayback').style.display = 'block';

                            // Criar um link para download
                            const downloadLink = document.getElementById('downloadLink');
                            downloadLink.href = audioUrl;
                            downloadLink.download = 'gravacao.wav';
                            downloadLink.innerText = 'Baixar Gravação';
                            downloadLink.style.display = 'block';

                            audioChunks = []; // Limpar os chunks após a gravação
                            heartContainer.style.animationPlayState = 'paused'; // Para a animação do coração
                        };

                        mediaRecorder.start();
                        document.getElementById('stopButton').disabled = false;
                        heartContainer.style.animationPlayState = 'running'; // Inicia a animação do coração
                    })
                    .catch(err => console.error('Erro ao acessar o microfone: ', err));
            }

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript.toLowerCase();
                console.log(transcript); // Para depuração

                if (transcript.includes('pulsar')) {
                    startRecording(); // Chama a função para iniciar a gravação se "pulsar" for detectada
                }
            };


            recognition.onerror = (event) => {
                console.error('Erro de reconhecimento: ', event.error);
            };

            recognition.onend = () => {
                recognition.start(); // Reinicia o reconhecimento após terminar
            };

            recognition.start(); // Inicia o reconhecimento quando a página carrega

        } else {
            console.error("SpeechRecognition não suportado neste navegador.");
            alert("Desculpe, esta funcionalidade de reconhecimento de voz não é suportada pelo seu navegador.");
        }
    </script>
</body>
</html>                

